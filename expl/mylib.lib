PUSH BP
MOV BP,SP
MOV R1,6
MOV R0,BP
SUB R0,R1
MOV R0,[R0]
MOV R5,R0
MOV R1,R0
MOV R2, "Alloc"
EQ R1, R2
JZ R1, 42
MOV R0, [2040]
MOV R1, [R0]
MOV [2040], R1
MOV R1, BP
MOV R2, 2
SUB R1, R2
MOV [R1], R0
MOV BP, [SP]
POP R0
RET
MOV R1,R5
MOV R2, "Free"
EQ R1, R2
JZ R1, 70
MOV R0, 5
MOV R1, BP
SUB R1, R0
MOV R0, [R1]
MOV R1, [2040]
MOV [2040], R0
MOV [R0], R1
MOV BP, [SP]
POP R0
RET
MOV R1,R5
MOV R2, "Heapset"
EQ R1, R2
JZ R1, 196
MOV R0,1024
MOV R1,1
MOV [R0],-1
ADD R0,R1
MOV R2,2047
GE R2,R0
JZ R2,94
JMP 82
MOV R0,1024
MOV R1,1032
MOV R3,8
MOV [R0],R1
ADD R1,R3
ADD R0,R3
MOV R2,2047
GE R2,R0
JZ R2,114
JMP 100
MOV [2032],-1
MOV [2040],1024
MOV BP, [SP]
POP R0
RET
MOV R0,R7
PUSH R0
MOV R1,BP
MOV R0,5
SUB R1,R0
MOV R0,[R1]
PUSH R0
ADD R1,1
MOV R0,[R1]
PUSH R0
ADD R1,1
MOV R0,[R1]
PUSH R0
PUSH R0
MOV R1,R5
MOV R0, "Write"
EQ R0,R1
JNZ R0, 160
INT 7
JMP 164
MOV R1,BP
MOV R0,5
ADD R1,R0
MOV R2,BP
MOV R0,2
SUB R2,R0
MOV R3,[R1]
MOV [R2],R3
POP R0
POP R0
POP R0
POP R0
POP R0
MOV BP,[SP]
POP R0
RET
MOV R1,R5
MOV R2, "Write"
EQ R1, R2
JZ R1, 408
MOV R7,5
JMP 124
RET
